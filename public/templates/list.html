{% extends "base.html" %}

{% block content %}

<div class="list-header">
    <h1>{{ title }}</h1>
    <div>
        <a href="{{ url_for(entity_name + '.create') }}" class="btn btn-add">Add</a>
        {% if entity_name in ('customers', 'titles') %}
            <a href="{{ url_for(entity_name + '.bulk_add') }}" class="btn btn-bulk-add">Bulk-Add</a>
        {% endif %}
    </div>
</div>

<div class="table-responsive">
<table class="data-table">
    <thead>
        <tr>
            {% for head in headers %}
                <th>{{ head }}</th>
            {% endfor %}
            <th>Actions</th> </tr>
    </thead>
    <tbody>
        {% for row in rows %}
        <tr>
            {% for cell in row.data_values %}
                <td>{{ cell if cell is not none else 'Unknown' }}</td>
            {% endfor %}

            <td class="actions-cell">
                <a href="{{ url_for(entity_name + '.edit', id=row.id) }}" class="btn btn-edit">Edit</a>

                {% if entity_name == 'loans' %}
                    <a href="{{ url_for('loans.edit', id=row.id, action='return') }}" class="btn {{ 'btn-return' if row.can_return else 'btn-disabled' }}">close loan</a>
                {% endif %}

                <form action="{{ url_for(entity_name + '.delete', id=row.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this record?');">
                    <button type="submit" class="btn btn-delete">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
<nav class="page-nav">
  <ul class="page-list">

    <li class="page-item {% if page == 1 %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for(request.endpoint, page=page-1) }}">
        &larr; Previous
      </a>
    </li>

    <li class="page-item disabled">
      <span class="page-link">Page {{ page }}</span>
    </li>

    <li class="page-item {% if not has_next %}disabled{% endif %}">
      <a class="page-link" href="{{ url_for(request.endpoint, page=page+1) }}">
        Next &rarr;
      </a>
    </li>

  </ul>
</nav>

{% endblock %}